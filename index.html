<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>ทะเบียนถังดับเพลิง</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; padding: 16px; }
    h2 { text-align: center; }
    table { width: 100%; border-collapse: collapse; }
    td { border: 1px solid #999; padding: 10px; }
    .label { background: #f5f5f5; font-weight: bold; width: 40%; }

    .header {
  display: flex;            /* ใช้ Flexbox จัดเรียงโลโก้กับข้อความ*/
  justify-content: center;   /* จัดกึ่งกลางแนวนอน */
  align-items: center;       /* จัดกึ่งกลางแนวตั้ง */
  gap: 12px;                /* ระยะห่างระหว่างโลโก้กับข้อความ */
  margin-bottom: 10px;      /* เว้นระยะด้านล่างของ header  */
  box-shadow: 0 2px 6px rgba(0,0,0,0.3); /* ใส่เงาให้ header ดูมีมิติ */
  background-color: #000;   /* พื้นหลังดำ */
  padding: 12px 20px;      /* ระยะขอบด้านใน (บน-ล่าง 12px / ซ้าย-ขวา 20px)  */
}

.header h2 {
  color: #fff;              /* ตัวอักษรขาว */
  margin: 0;                /* เอา margin เริ่มต้นของ h2 ออก */
}

.logo {
  height: 75px;   /* ปรับขนาดโลโก้ */
  padding: 4px;   /* เว้นขอบด้านในรอบโลโก้ */
  border-radius: 4px;  /* ทำมุมพื้นหลังโลโก้ให้โค้งมนเล็กน้อย */
}

  </style>
</head>
<body>

<div class="header">
  <img src="Logo Nittan.png" alt="logo" class="logo">
  <h2>ทะเบียนถังดับเพลิง</h2>
</div>
<div id="output">กำลังโหลด...</div>

<script>
const params = new URLSearchParams(window.location.search);
const id = params.get("id");
const output = document.getElementById("output");

if (!id) {
  output.textContent = "ไม่พบ id";
  throw new Error("missing id");
}

const allowedFields = [
  "หมายเลขถัง",
  "Zone",
  "พื้นที่",
  "ชนิด ",
  "น้ำหนัก",
  "ยี่ห้อ",
  "ปีที่ผลิต / ติดตั้ง / Hydro test ล่าสุด"
];

fetch("https://script.google.com/macros/s/AKfycbwQZVPvTFlIXhu5GoGS1N-521zIMa9w2znbPkLr4txxyqbXfimNj_8830-5rYiKonnA/exec")
  .then(res => res.json())
  .then(data => {

    const record = data[id]; // ✅ จุดแก้จริง

    if (!record) {
      output.textContent = "ไม่พบข้อมูล";
      return;
    }

    let html = "<table cellpadding='10' cellspacing='0'>";

    allowedFields.forEach(key => {
      if (record[key] !== undefined && record[key] !== "") {
        html += `
          <tr>
            <td class="label">${key}</td>
            <td>${record[key]}</td>
          </tr>
        `;
      }
    });

    html += "</table>";
    output.innerHTML = html;
  })
  .catch(err => {
    output.textContent = "โหลดข้อมูลไม่สำเร็จ";
    console.error(err);
  });
</script>



</body>
</html>
