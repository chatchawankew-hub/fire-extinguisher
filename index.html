<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>ทะเบียนถังดับเพลิง</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

  <div id="output">กำลังโหลด...</div>

  <script>
  // ================================
  // STEP 3.1 อ่านค่า id จาก URL
  // ================================
  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");
  const output = document.getElementById("output");

  if (!id) {
    output.textContent = "ไม่พบ id";
    throw new Error("missing id");
  }

  // ================================
  // STEP 3.2 URL ของ Apps Script
  // ================================
  const API_URL =
    "https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLjjYzGIJGJQbipvIOGNxoh4sioZwVR4zLpzTAEsgVtPkoMhpGOiA4_yvbbkyaudbnJWl14h4063bhIPdwNBsRELl0ApEYPaaa8epi-f5FShQqG-_dtVc1NZFWLJ7uyoAgibBMaOVWm8eNBXdtQ8lry5eYsZhhUqErK2ce4Idm9w7pfuaNFcZk_nSrS9cuwXrQn8mHit6CNzNjjqysyGVElrb74hagA-WdqfDr3o95Ee22QNBJ5LoiJcvtf_KAptx7hAwakLa2-DhJ2FiK24mSTNPrvMDBhTfo65NQl4FnburNLQHjY&lib=M3C5JUJUXRnbBRDJCytGGQXTSKsXQ50gu" + "?id=" + id;

  // ================================
  // STEP 3.3 รายการ field ที่ต้องแสดง
  // ================================
  const allowedFields = [
    "หมายเลขถัง",
    "id ถังดับเพลิง",
    "Zone",
    "พื้นที่",
    "ชนิด ",
    "น้ำหนัก",
    "ยี่ห้อ",
    "ปีที่ผลิต / ติดตั้ง / Hydro test ล่าสุด"
  ];

  // ================================
  // STEP 3.4 เรียก JSON
  // ================================
  fetch(API_URL)
    .then(res => res.json())
    .then(data => {

      let html = "<table>";

      // วนเฉพาะ field ที่ต้องการ
      allowedFields.forEach(key => {
        if (data[key] !== undefined && data[key] !== "") {
          html += `
            <tr>
              <td>${key}</td>
              <td>${data[key]}</td>
            </tr>
          `;
        }
      });

      html += "</table>";
      output.innerHTML = html;
    })
    .catch(err => {
      output.textContent = "โหลดข้อมูลไม่สำเร็จ";
      console.error(err);
    });
</script>



</body>
</html>
