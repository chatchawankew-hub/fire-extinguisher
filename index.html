<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ñ‡∏±‡∏á‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

  <div id="output">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>

  <script>
  // ================================
  // STEP 3.1 ‡∏≠‡πà‡∏≤‡∏ô id ‡∏à‡∏≤‡∏Å URL
  // ================================
  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");
  const output = document.getElementById("output");

  if (!id) {
    output.textContent = "‡πÑ‡∏°‡πà‡∏û‡∏ö id";
    throw new Error("missing id");
  }

  // ================================
  // STEP 3.2 URL Apps Script
  // ================================
  const API_URL =
    "https://script.google.com/macros/s/AKfycbxlnE9Yi5MRz2xnZiXZQdmPXR1u-HD7lterkTVqKF9ujxFQYSfLx30Km69i_b4KCNKM/exec?id=" + id;

  // ================================
  // STEP 3.3 field ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á
  // ================================
  const allowedFields = [
    "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ñ‡∏±‡∏á",
    "id ‡∏ñ‡∏±‡∏á‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á",
    "Zone",
    "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà",
    "‡∏ä‡∏ô‡∏¥‡∏î ",
    "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å",
    "‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠",
    "‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï / ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á / Hydro test ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"
  ];

  // ================================
  // STEP 3.4 ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API (‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô text)
  // ================================
  fetch(API_URL)
    .then(res => res.text()) // üëà ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å
    .then(text => {
      const data = JSON.parse(text); // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏≠‡∏á

      let html = "<table border='1' cellpadding='8' cellspacing='0'>";

      allowedFields.forEach(key => {
        if (data[key] !== undefined && data[key] !== "") {
          html += `
            <tr>
              <td><strong>${key}</strong></td>
              <td>${data[key]}</td>
            </tr>
          `;
        }
      });

      html += "</table>";
      output.innerHTML = html;
    })
    .catch(err => {
      output.textContent = "‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
      console.error(err);
    });
</script>




</body>
</html>
